import{_ as v}from"./app.523dd8ec.js";import{$ as _}from"./jquery.70db95b2.js";import"./jquery.dataTables.min.aec3f10c.js";import{o as d,e as l,j as t,M as h,h as c,F as f,J as y,x as n,K as u,N as p,k,I as m}from"./vue.esm-bundler.5523ad96.js";const x={data:function(){return{systems:[],loading:!0,form_title:"Nuevo Sistema",form_data:{id:"",name:"",active:1},form_action:"",form_error:"",form_okbtn_text:"Aceptar",form_color:"green",form_loading:!1,delete_text:"Eliminar",delete_id:"",delete_system:"",delete_error:"",delete_loading:!1,session:JSON.parse(sessionStorage.getItem("semtinel"))}},watch:{form_okbtn_text:function(e){e=="Aceptar"?this.form_loading=!1:this.form_loading=!0},form_action:function(e){switch(e){case"create":this.form_color="green";break;case"edit":this.form_color="orange";break;default:this.form_color="danger";break}}},methods:{listReload:function(){this.getSystemsTable()},isValidForm:function(){return this.form_data.name==null||this.form_data.name==""?(this.form_error="Debe escribir un Nombre para el sistema.",!1):!0},async getSystemsTable(){let e=this;this.loading=!0;let o={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+e.session.access_token};await fetch("http://localhost/semtinel/public/api/admin/systems",{method:"GET",headers:o}).then(s=>s.json()).then(s=>{e.systems=s,e.loading=!1,_("#datatable").DataTable().destroy()&&setTimeout(()=>{_("#datatable").DataTable({lengthMenu:[[10,15,25,50,-1],[10,15,25,50,"Todos"]],pageLength:10,order:[[1,"asc"]],columnDefs:[{targets:"no-sort",orderable:!1,order:[]}],columns:[{width:"5%"},null,{width:"10%"},{width:"10%"},{width:"10%"}],language:{decimal:"",emptyTable:"No hay informaci\xF3n",info:"Mostrando _START_ a _END_ de _TOTAL_ Registros",infoEmpty:"Mostrando 0 to 0 of 0 Entradas",infoFiltered:"(Filtrado de _MAX_ total registros)",infoPostFix:"",thousands:",",lengthMenu:"Mostrar _MENU_ Registros",loadingRecords:"Cargando...",processing:"Procesando...",search:"Buscar: ",zeroRecords:"Sin resultados encontrados",paginate:{first:"Primero",last:"Ultimo",next:"Siguiente",previous:"Anterior"}}})})}).catch(s=>{this.errorMessage=s,toastr.error("Error: "+s)})},create:function(){this.form_action="create",this.form_error="",this.form_title="Nuevo Sistema",this.form_data.id="",this.form_data.name="",this.form_data.active=1},edit:function(e,o,s){this.form_action="edit",this.form_error="",this.form_title="Editar Sistema",this.form_data.id=e,this.form_data.name=o,this.form_data.active=s},activeSystem:function(){this.form_data.active==1?this.form_data.active=0:this.form_data.active=1},deleteDialog:function(e,o){this.delete_id=e,this.delete_system=o},async store(){let e=this;if(!e.isValidForm())return;e.form_error="",e.form_okbtn_text="Procesando...";let o={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+e.session.access_token};await axios.post("http://localhost/semtinel/public/api/admin/system",{id:e.form_data.id,name:e.form_data.name,active:e.form_data.active},{headers:o}).then(function(s){s.data.success?(e.form_error="",e.form_okbtn_text="Aceptar",e.$refs.Close.click(),e.form_action=="create"?toastr.success("El Sistema fue Agregado con \xE9xito."):e.form_action=="edit"&&toastr.success("El Sistema fue Actualizado con \xE9xito."),e.listReload()):(e.form_error="",e.form_okbtn_text="Aceptar",toastr.error("Error al intentar realizar la operaci\xF3n."))}).catch(function(s){e.form_error="Ha ocurrido un error. Por favor, prueba nuevamente.",e.form_okbtn_text="Aceptar"})},async destroy(){let e=this;e.delete_error="",e.delete_loading=!0,e.delete_text="Procesando...";let o={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+e.session.access_token};await axios.delete("http://localhost/semtinel/public/api/admin/system/"+e.delete_id,{headers:o},{}).then(function(s){s.data.success?(e.delete_error="",e.delete_loading=!1,e.delete_text="Eliminar",e.$refs.delClose.click(),toastr.success("El Sistema fue Eliminado con \xE9xito."),e.listReload()):(e.delete_error="",e.delete_loading=!1,e.delete_text="Eliminar",toastr.error("Error al intentar realizar la operaci\xF3n."))}).catch(function(s){e.delete_error="Ha ocurrido un error. Por favor, prueba nuevamente.",e.form_okbtn_text="Eliminar",e.delete_loading=!1})}},mounted(){var e=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));e.map(function(i){return new bootstrap.Tooltip(i)});let o=this;JSON.parse(sessionStorage.getItem("semtinel")).access_token||(sessionStorage.clear(),window.document.location.href="http://localhost/semtinel/login");let s={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+o.session.access_token};fetch("http://localhost/semtinel/public/api/admin/systems",{method:"GET",headers:s}).then(i=>i.json()).then(i=>{o.systems=i,o.loading=!1,setTimeout(()=>{_("#datatable").DataTable({retrieve:!0,lengthMenu:[[10,15,25,50,-1],[10,15,25,50,"Todos"]],pageLength:10,order:[[1,"asc"]],columnDefs:[{targets:"no-sort",orderable:!1,order:[]}],language:{decimal:"",emptyTable:"No hay informaci\xF3n",info:"Mostrando _START_ a _END_ de _TOTAL_ Registros",infoEmpty:"Mostrando 0 to 0 of 0 Entradas",infoFiltered:"(Filtrado de _MAX_ total registros)",infoPostFix:"",thousands:",",lengthMenu:"Mostrar _MENU_ Registros",loadingRecords:"Cargando...",processing:"Procesando...",search:"Buscar: ",zeroRecords:"Sin resultados encontrados",paginate:{first:"Primero",last:"Ultimo",next:"Siguiente",previous:"Anterior"}}})})}).catch(i=>{this.errorMessage=i,toastr.error("Error: "+i)})}},A={class:"container-fluid px-0"},E={class:"card"},S={class:"card-header"},w=t("h3",{class:"card-title"},"Semtinel Apps",-1),C={class:"card-tools"},T=t("i",{class:"mdi mdi-reload mdi-24px text-green"},null,-1),M=[T],N=t("i",{class:"mdi mdi-plus-circle mdi-24px text-green"},null,-1),R=[N],D={class:"card-body"},j=t("div",{class:"col-12 text-center py-5 loading-table"},[t("span",{class:"mdi mdi-loading mdi-spin mdi-36px"},"\xA0Cargando sistemas...")],-1),z=[j],F={class:"col-12"},P={id:"datatable",class:"table table-striped"},U=t("thead",null,[t("tr",null,[t("th",{width:"5%",class:"text-center no-sort"},"No."),t("th",null,"Nombre"),t("th",{width:"10%",class:"text-center no-sort"},"Activo"),t("th",{width:"10%",class:"text-center no-sort"},"Modificar"),t("th",{width:"10%",class:"text-center no-sort"},"Eliminar")])],-1),B={class:"text-center"},L={class:"text-center"},V={class:"text-center"},$=["onClick"],O=t("span",{class:"mdi mdi-pencil mdi-18px text-orange"},null,-1),q=[O],I={class:"text-center"},J=["onClick"],G=t("span",{class:"mdi mdi-trash-can-outline mdi-18px text-danger"},null,-1),H=[G],X={class:"modal fade",id:"modal-system-form","aria-hidden":"true",role:"dialog","data-backdrop":"static","data-keyboard":"false"},K={class:"modal-dialog"},Q={class:"modal-content"},W={class:"modal-title"},Y={type:"button",ref:"Close",class:"close","data-dismiss":"modal","aria-label":"Close"},Z=t("span",{"aria-hidden":"true"},"\xD7",-1),tt=[Z],et={class:"modal-body px-4"},ot={class:"row"},st={class:"col-md-12"},at={class:"form-group"},it=t("label",{for:"name"},"Nombre:",-1),rt={class:"row"},nt={class:"col-md-12"},dt={class:"form-check ml-1"},lt=["checked"],ct=t("label",{class:"form-check-label",for:"syst_active"},"Activo",-1),mt={key:0,class:"row pt-2"},_t={class:"col-12 text-center"},ht={class:"form_error"},ft={class:"modal-footer justify-content-between"},ut=t("button",{type:"button",class:"btn btn-default ripple","data-dismiss":"modal"},"Cancelar",-1),pt=["disabled"],gt={key:0,class:"mdi mdi-check-all"},bt={key:1,class:"mdi mdi-loading mdi-spin"},vt={class:"modal fade",id:"modal-system-delete","aria-hidden":"true",role:"dialog","data-backdrop":"static","data-keyboard":"false"},yt={class:"modal-dialog modal-lg"},kt={class:"modal-content"},xt={class:"modal-header header-danger"},At=t("h4",{class:"modal-title"},"Confirmaci\xF3n",-1),Et={type:"button",ref:"delClose",class:"close","data-dismiss":"modal","aria-label":"Close"},St=t("span",{"aria-hidden":"true"},"\xD7",-1),wt=[St],Ct={class:"modal-body px-4"},Tt=t("div",{class:"float-start",style:{width:"70px"}},[t("i",{class:"mdi mdi-chat-question mdi-48px"})],-1),Mt={class:"float-start pt-3",style:{width:"85%"}},Nt=t("br",null,null,-1),Rt={class:"modal-footer justify-content-between"},Dt=t("button",{type:"button",class:"btn btn-default","data-dismiss":"modal"},"Cancelar",-1),jt=["disabled"],zt=t("i",{class:"mdi mdi-trash-can-outline"},null,-1);function Ft(e,o,s,i,Pt,r){return d(),l(f,null,[t("div",A,[t("div",E,[t("div",S,[w,t("div",C,[t("button",{type:"button",class:"btn btn-tool pr-2","data-bs-toggle":"tooltip",title:"Recargar Listado",onClick:o[0]||(o[0]=h(a=>r.listReload(),["stop"]))},M),t("button",{type:"button",class:"btn btn-tool pl-0","data-bs-toggle":"tooltip",title:"Nuevo Sistema","data-toggle":"modal","data-target":"#modal-system-form",onClick:o[1]||(o[1]=a=>r.create())},R)])]),t("div",D,[t("div",{class:c(["row",e.loading?"":"hidden"])},z,2),t("div",{class:c(["row",e.loading?"hidden":""])},[t("div",F,[t("table",P,[U,t("tbody",null,[(d(!0),l(f,null,y(e.systems,(a,g)=>(d(),l("tr",{key:a.id},[t("td",B,n(g+1),1),t("td",null,n(a.name),1),t("td",L,[t("span",{class:c(["mdi mdi-18px",a.active?"mdi-checkbox-marked-circle":"mdi-checkbox-blank-circle-outline"])},null,2)]),t("td",V,[t("a",{title:"Editar registro",href:"javascript:void(0);",class:"btn-semti-tool",style:{padding:"4px 5px"},"data-toggle":"modal","data-target":"#modal-system-form",onClick:b=>r.edit(a.id,a.name,a.active)},q,8,$)]),t("td",I,[t("a",{title:"Eliminar registro",href:"javascript:void(0);",class:"btn-semti-tool",style:{padding:"4px 5px"},"data-toggle":"modal","data-target":"#modal-system-delete",onClick:b=>r.deleteDialog(a.id,a.name)},H,8,J)])]))),128))])])])],2)])])]),t("div",X,[t("div",K,[t("div",Q,[t("div",{class:c(["modal-header","header-"+e.form_color])},[t("h4",W,n(e.form_title),1),t("button",Y,tt,512)],2),t("div",et,[t("form",null,[u(t("input",{type:"hidden",name:"id_system",id:"id_system","onUpdate:modelValue":o[2]||(o[2]=a=>e.form_data.id=a)},null,512),[[p,e.form_data.id]]),t("div",ot,[t("div",st,[t("div",at,[it,u(t("input",{type:"text",class:"form-control",id:"name",name:"name",placeholder:"Nombre del sistema","onUpdate:modelValue":o[3]||(o[3]=a=>e.form_data.name=a)},null,512),[[p,e.form_data.name]])])])]),t("div",rt,[t("div",nt,[t("div",dt,[t("input",{type:"checkbox",class:"form-check-input",id:"syst_active",name:"syst_active",checked:e.form_data.active,onChange:o[4]||(o[4]=a=>r.activeSystem())},null,40,lt),ct])])]),e.form_error!=""?(d(),l("div",mt,[t("div",_t,[t("h6",ht,n(e.form_error),1)])])):k("",!0)])]),t("div",ft,[ut,t("button",{type:"button",class:c(["btn btn-primary ripple","btn-"+e.form_color]),disabled:e.form_loading,onClick:o[5]||(o[5]=h(a=>r.store(),["stop"]))},[e.form_loading?(d(),l("i",bt)):(d(),l("i",gt)),m(" \xA0"+n(e.form_okbtn_text),1)],10,pt)])])])]),t("div",vt,[t("div",yt,[t("div",kt,[t("div",xt,[At,t("button",Et,wt,512)]),t("div",Ct,[Tt,t("div",Mt,[t("p",null,[m('El Sistema "'),t("strong",null,n(e.delete_system),1),m('" ser\xE1 Eliminado de la plataforma Semtinel.'),Nt,m("Confirme que desea realizar esta operaci\xF3n.")])])]),t("div",Rt,[Dt,t("button",{type:"button",class:"btn btn-danger ripple",disabled:e.delete_loading,onClick:o[6]||(o[6]=a=>r.destroy())},[zt,m("\xA0"+n(e.delete_text),1)],8,jt)])])])])],64)}const $t=v(x,[["render",Ft]]);export{$t as default};
