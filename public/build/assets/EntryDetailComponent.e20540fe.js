import{_ as k,P as C}from"./app.523dd8ec.js";import{o as i,e as n,s as j,j as t,I as p,x as o,K as d,h as c,M as m,F as y,k as u,J as v,N as E,i as D,L as P}from"./vue.esm-bundler.5523ad96.js";import{_ as F,a as U,b as q}from"./icon-jpg.b5720497.js";const N={data:function(){return{entry:{},pagetitle:"",upload_id:"",upload_entry:"",upload_file:"",upload_form_error:{error_text:""},upload_form_loading:!1,upload_form_okbtn_text:"Adjuntar",upload_entry:"",table_oc:!0,show_details:!1,item_details:{docnum:"",product_quantity:"",cod_product:"",oc:"",generic_descript:"",item_description:"",um:"",received_quantity:0,stowage_card:"-",price_unit:"",price_total:0,comment:""},confirm_loading:!1,cancel_loading:!1,confirm_text:"Confirmar",session:JSON.parse(sessionStorage.getItem("semtinel")),pole:localStorage.getItem("stnel_logist_pole"),project:localStorage.getItem("stnel_logist_project")}},created(){this.entry=JSON.parse(this.$route.params.entry),this.pagetitle=this.entry.document_number,this.entry.type=="oc"?this.table_oc=!0:this.table_oc=!1,this.entry.confirm==1?this.confirm_text="Confirmada":this.confirm_text="Confirmar"},watch:{upload_form_loading:function(e){e?this.upload_form_okbtn_text="Procesando...":this.upload_form_okbtn_text="Adjuntar"}},components:{"page-header":C},methods:{openScanner:function(e){window.open("http://localhost/semtinel/storage/app/public/"+e,"_blank","noreferrer")},docPdf:function(e){window.open("http://localhost/semtinel/public/api/logistics/pdf/entry/"+e,"_blank","noreferrer")},show:function(e){let s=this;s.table_oc?s.item_details={cod_product:s.entry.items[e].product_code,oc:s.entry.oc,generic_descript:s.entry.items[e].product_description,item_description:s.entry.items[e].item_description,um:s.entry.items[e].um,received_quantity:s.entry.items[e].received_quantity,stowage_card:s.entry.items[e].stowage_card,price_unit:s.entry.items[e].price_unit,price_total:s.entry.items[e].price_total,comment:s.entry.items[e].comment==""?"-":s.entry.items[e].comment}:s.item_details={cod_product:s.entry.items[e].product_code,oc:s.entry.items[e].oc,docnum:s.entry.items[e].docnum,item_description:s.entry.items[e].item_description,um:s.entry.items[e].um,product_quantity:s.entry.items[e].product_quantity,received_quantity:s.entry.items[e].received_quantity,stowage_card:s.entry.items[e].stowage_card,price_unit:s.entry.items[e].price_unit,price_total:s.entry.items[e].price_total,comment:s.entry.items[e].comment==""?"-":s.entry.items[e].comment},s.show_details=!0},attachFile:function(e,s){this.$refs.uploadFile.value=null,this.upload_form_error.error_text="",this.upload_id=e,this.upload_entry=s},onChangeFile(e){this.upload_file=e.target.files[0],this.upload_form_error.error_text=""},uploadDoc:function(){let e=this;if(e.upload_form_loading=!0,e.$refs.uploadFile.value==""){e.upload_form_error.error_text="Debe seleccionar el archivo que desea adjuntar.",e.upload_form_loading=!1;return}e.upload_form_error.error_text="";let s=new FormData,h={"content-type":"multipart/form-data",Authorization:"Bearer "+e.session.access_token};s.append("id",e.upload_id),s.append("entry",e.upload_entry),s.append("file",e.upload_file),s.append("user",e.session.id),s.append("pole",e.pole),s.append("project",e.project),axios.post("http://localhost/semtinel/public/api/logistics/entry/upload",s,{headers:h}).then(function(f){if(f.data.success){e.$refs.CloseUpload.click(),e.upload_form_loading=!1,e.entry.attach_path=f.data.path;let g=e.entry.attach_path.split(".");e.entry.attach_type=g[1],toastr.success("El archivo fue adjuntado con \xE9xito.")}else e.$refs.CloseUpload.click(),e.upload_form_loading=!1,toastr.error("Error al intentar realizar la operaci\xF3n.")}).catch(function(f){e.$refs.CloseUpload.click(),e.upload_form_loading=!1,toastr.error("Error al intentar realizar la operaci\xF3n.")})},confirmEntry:function(){let e=this;e.confirm_loading=!0;let s={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+e.session.access_token};axios.post("http://localhost/semtinel/public/api/logistics/entry/confirm",{entry:e.entry.id,user:e.session.id,pole:e.pole,project:e.project},{headers:s}).then(function(h){h.data.success?(e.confirm_loading=!1,e.entry.confirm=1,e.confirm_text="Confirmada",toastr.success("La Entrada fue Confirmada con \xE9xito.")):(e.confirm_loading=!1,toastr.error("Error al intentar realizar la operaci\xF3n."))}).catch(function(h){e.confirm_loading=!1,toastr.error("Error al intentar realizar la operaci\xF3n.")})},cancelEntry:function(){let e=this;e.cancel_loading=!0;let s={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+e.session.access_token};axios.post("http://localhost/semtinel/public/api/logistics/entry/cancel",{entry:e.entry.id,user:e.session.id,pole:e.pole,project:e.project},{headers:s}).then(function(h){h.data.success?(e.cancel_loading=!1,toastr.success("La Entrada fue Cancelada con \xE9xito."),e.$router.push("/semtinel/logistics/entries")):(e.cancel_loading=!1,toastr.error("Error al intentar realizar la operaci\xF3n."))}).catch(function(h){e.cancel_loading=!1,toastr.error("Error al intentar realizar la operaci\xF3n.")})}}},A={class:"invoice p-3 mb-3"},S={class:"row"},z={class:"col-sm-6"},T=t("i",{class:"mdi mdi-truck-check-outline mdi-36px align-middle"},null,-1),$={class:"col-sm-6 text-right"},I=t("i",{class:"fas fa-file-pdf"},null,-1),M=t("i",{class:"fas fa-paperclip"},null,-1),B={class:"row invoice-info"},J={class:"col-sm-3 invoice-col"},O={class:"form-group"},V=t("label",{class:"mb-1"},"Origen",-1),G={class:"p-0"},L={class:"form-group"},R=t("label",{class:"mb-1"},"Tipo de documento",-1),H={class:"p-0"},K={class:"form-group"},Q=t("label",{class:"mb-1"},"No. documento",-1),W={class:"p-0"},X={class:"form-group"},Y=t("label",{class:"mb-1"},"Orden de Compra",-1),Z={class:"p-0"},x={class:"col-sm-3 invoice-col"},tt={class:"form-group"},et=t("label",{class:"mb-1"},"Destino",-1),st={class:"p-0"},ot={class:"form-group"},at=t("label",{class:"mb-1"},"Responsable",-1),it={class:"p-0"},nt={class:"form-group"},lt=t("label",{class:"mb-1"},"Polo",-1),rt={class:"p-0"},dt={class:"form-group"},ct=t("label",{class:"mb-1"},"Proyecto",-1),_t={class:"p-0"},pt={class:"col-sm-3 invoice-col"},ht={class:"form-group"},mt=t("label",{class:"mb-1"},"Estado",-1),ut=t("br",null,null,-1),ft={class:"form-group"},yt=t("label",{class:"mb-1"},"Documento escaneado",-1),gt=t("br",null,null,-1),vt={src:F,alt:"Documento Escaneado"},bt={src:U,alt:"Documento Escaneado"},wt={src:q,alt:"Documento Escaneado"},kt={key:0,class:"badge badge-danger"},Ct={class:"col-12 table-responsive"},jt={class:"table table-striped"},Et=t("thead",null,[t("tr",null,[t("th",{width:"50",class:"text-center no-sort"},"No."),t("th",null,"Descripci\xF3n"),t("th",{width:"100",class:"text-center no-sort"},"UM"),t("th",{width:"100",class:"text-center no-sort"},"Ctdad Recibida"),t("th",{width:"100",class:"text-right no-sort"},"Precio Unitario"),t("th",{width:"130",class:"text-right no-sort"},"Importe Total"),t("th",{width:"150",class:"text-center no-sort"},"Tarjeta Estiba"),t("th",{width:"300",class:"no-sort"},"Comentario")])],-1),Dt={class:"text-center"},Pt=["onClick"],Ft={class:"text-center"},Ut=["id"],qt={class:"text-right"},Nt=["id"],At=["id"],St=["id"],zt={class:"col-12 table-responsive"},Tt={class:"table table-striped"},$t=t("thead",null,[t("tr",null,[t("th",{width:"50",class:"text-center no-sort"},"No."),t("th",null,"Descripci\xF3n"),t("th",{width:"100",class:"text-center no-sort"},"UM"),t("th",{width:"100",class:"text-center no-sort"},"Ctdad Despachada"),t("th",{width:"100",class:"text-center no-sort"},"Ctdad Recibida"),t("th",{width:"100",class:"text-right no-sort"},"Precio Unitario"),t("th",{width:"130",class:"text-right no-sort"},"Importe Total"),t("th",{width:"150",class:"text-center no-sort"},"Tarjeta Estiba"),t("th",{width:"300",class:"no-sort"},"Comentario")])],-1),It={class:"text-center"},Mt=["onClick"],Bt={class:"text-center"},Jt={class:"text-center"},Ot=["id"],Vt={class:"text-right"},Gt=["id"],Lt=["id"],Rt=["id"],Ht={class:"modal fade",id:"modal-upload-form","aria-hidden":"true",role:"dialog","data-backdrop":"static","data-keyboard":"false"},Kt={class:"modal-dialog"},Qt={class:"modal-content"},Wt={class:"modal-header header-green"},Xt=t("h4",{class:"modal-title"},"Adjuntar documento escaneado",-1),Yt={type:"button",ref:"CloseUpload",class:"close","data-dismiss":"modal","aria-label":"Close"},Zt=t("span",{"aria-hidden":"true"},"\xD7",-1),xt=[Zt],te={class:"modal-body px-4"},ee={enctype:"multipart/form-data"},se={class:"row pt-3 pb-1"},oe={class:"col-md-12"},ae={class:"text-green"},ie={class:"row"},ne={class:"col-md-12"},le={class:"form-group"},re=t("span",{class:"info-container"},[t("span",{class:"text-sm text-muted"},"Seleccione solo archivos con extensiones PDF, JPG, JPEG, PNG")],-1),de={key:0,class:"row pt-2"},ce={class:"col-12 text-center"},_e={class:"form_error"},pe={class:"modal-footer justify-content-between"},he=t("button",{type:"button",class:"btn btn-default ripple","data-dismiss":"modal"},"Cancelar",-1),me=["disabled"],ue={key:0,class:"mdi mdi-paperclip"},fe={key:1,class:"mdi mdi-loading mdi-spin"},ye={class:"modal fade",id:"modal-item-details","aria-hidden":"true",role:"dialog","data-backdrop":"static","data-keyboard":"false"},ge={class:"modal-dialog"},ve={class:"modal-content"},be={class:"modal-header header-info"},we=t("h4",{class:"modal-title"},"Detalles Producto",-1),ke={type:"button",ref:"Close",class:"close","data-dismiss":"modal","aria-label":"Close"},Ce=t("span",{"aria-hidden":"true"},"\xD7",-1),je=[Ce],Ee={class:"modal-body px-4 rounded-bottom"},De={class:"row py-1"},Pe={class:"col-md-12"},Fe=t("span",{class:"detail-title"},"C\xF3digo del Producto",-1),Ue={class:"detail-desc"},qe={class:"row py-1"},Ne={class:"col-md-12"},Ae=t("span",{class:"detail-title"},"Orden de Compra",-1),Se={class:"detail-desc"},ze={key:0,class:"row py-1"},Te={class:"col-md-12"},$e=t("span",{class:"detail-title"},"Descripci\xF3n del Producto",-1),Ie={class:"detail-desc"},Me={key:1,class:"row py-1"},Be={class:"col-md-12"},Je=t("span",{class:"detail-title"},"Documento",-1),Oe={class:"detail-desc"},Ve={class:"row py-1"},Ge={class:"col-md-12"},Le=t("span",{class:"detail-title"},"Descripci\xF3n del Item",-1),Re={class:"detail-desc"},He={class:"row py-1 mt-2"},Ke=t("div",{class:"text-center"},[t("span",{class:"detail-title"},"UM")],-1),Qe={class:"detail-desc text-center"},We=t("div",{class:"text-center"},[t("span",{class:"detail-title"},"Ctdad Despachada")],-1),Xe={class:"detail-desc text-center"},Ye=t("div",{class:"text-center"},[t("span",{class:"detail-title"},"Ctdad Recibida")],-1),Ze={class:"detail-desc text-center"},xe={class:"row py-1"},ts={class:"col-md-4"},es=t("div",{class:"text-center"},[t("span",{class:"detail-title"},"Precio Unitario")],-1),ss={class:"detail-desc text-center"},os={class:"col-md-4"},as=t("div",{class:"text-center"},[t("span",{class:"detail-title"},"Importe Total")],-1),is={class:"detail-desc text-center"},ns={class:"col-md-4"},ls=t("div",{class:"text-center"},[t("span",{class:"detail-title"},"Tarjeta de Estiba")],-1),rs={class:"detail-desc text-center"},ds={key:2,class:"row py-1"},cs={class:"col-md-12"},_s=t("span",{class:"detail-title"},"Comentario",-1),ps={class:"detail-desc"};function hs(e,s,h,f,g,r){const b=D("page-header"),_=P("tooltip");return i(),n(y,null,[j(b,{pagetitle:"Detalle de la entrada "+e.pagetitle,breadcrumbs:!0,navbar:[{page:"Entradas",link:"/semtinel/logistics/entries",tooltip:"Click para regresar al listado de Entradas",active:!1},{page:"Detalle de entrada",link:"",tooltip:"",active:!0}]},null,8,["pagetitle"]),t("div",A,[t("div",S,[t("div",z,[t("h5",null,[T,p("\xA0\xA0Fecha de la entrada: "+o(e.entry.created_at),1)])]),t("div",$,[d((i(),n("a",{href:"javascript:void(0);",class:"btn btn-app system",onClick:s[0]||(s[0]=a=>r.docPdf(e.entry.id))},[I,p(" Exportar ")])),[[_,"Generar documento PDF"]]),d((i(),n("a",{href:"javascript:void(0);",class:"btn btn-app system","data-toggle":"modal","data-target":"#modal-upload-form",onClick:s[1]||(s[1]=a=>r.attachFile(e.entry.id,e.entry.document_number))},[M,p(" Adjuntar ")])),[[_,"Adjuntar documento escaneado"]]),d((i(),n("a",{href:"javascript:void(0);",class:c(["btn btn-app success",e.entry.confirm==1?"disabled":""]),onClick:s[2]||(s[2]=m(a=>r.confirmEntry(),["stop"]))},[t("i",{class:c(["fas",e.confirm_loading?"fa-spinner fa-pulse":"fa-check"])},null,2),p(" "+o(e.confirm_text),1)],2)),[[_,"Confirmar entrada"]]),d((i(),n("a",{href:"javascript:void(0);",class:c(["btn btn-app danger",e.entry.confirm==1?"disabled":""]),onClick:s[3]||(s[3]=m(a=>r.cancelEntry(),["stop"]))},[t("i",{class:c(["fas",e.cancel_loading?"fa-spinner fa-pulse":"fa-times"])},null,2),p(" Cancelar ")],2)),[[_,"Cancelar entrada"]])])]),t("div",B,[t("div",J,[t("div",O,[V,t("h6",G,[t("strong",null,o(e.entry.origin),1)])]),t("div",L,[R,t("h6",H,[t("strong",null,o(e.entry.document_type),1)])]),t("div",K,[Q,t("h6",W,[t("strong",null,o(e.entry.document_number),1)])]),t("div",X,[Y,t("h6",Z,[t("strong",null,o(e.entry.oc),1)])])]),t("div",x,[t("div",tt,[et,t("h6",st,[t("strong",null,o(e.entry.warehouse_name),1)])]),t("div",ot,[at,t("h6",it,[t("strong",null,o(e.entry.warehouse_owner),1)])]),t("div",nt,[lt,t("h6",rt,[t("strong",null,o(e.entry.pole_name),1)])]),t("div",dt,[ct,t("h6",_t,[t("strong",null,o(e.entry.project_name),1)])])]),t("div",pt,[t("div",ht,[mt,ut,t("span",{class:c(["badge",e.entry.status=="Parcial"?"badge-warning":"badge-dark"])}," Entrega "+o(e.entry.status),3)]),t("div",ft,[yt,gt,e.entry.attach_path!=""&&e.entry.attach_path!=null&&e.entry.attach_type=="pdf"?(i(),n("a",{key:0,href:"javascript:void(0);",onClick:s[4]||(s[4]=m(a=>r.openScanner(e.entry.attach_path),["stop"]))},[d(t("img",vt,null,512),[[_,"Click para abrir"]])])):e.entry.attach_path!=""&&e.entry.attach_path!=null&&e.entry.attach_type=="png"?(i(),n("a",{key:1,href:"javascript:void(0);",onClick:s[5]||(s[5]=m(a=>r.openScanner(e.entry.attach_path),["stop"]))},[d(t("img",bt,null,512),[[_,"Click para abrir"]])])):e.entry.attach_path!=""&&e.entry.attach_path!=null&&e.entry.attach_type=="jpg"?(i(),n("a",{key:2,href:"javascript:void(0);",onClick:s[6]||(s[6]=m(a=>r.openScanner(e.entry.attach_path),["stop"]))},[d(t("img",wt,null,512),[[_,"Click para abrir"]])])):(i(),n(y,{key:3},[e.entry.attach_path==""||e.entry.attach_path==null?(i(),n("span",kt," No se ha adjuntado el documento escaneado a\xFAn. ")):u("",!0)],64))])])]),t("div",{class:c(["row pt-4",e.table_oc?"":"hidden"])},[t("div",Ct,[t("table",jt,[Et,t("tbody",null,[(i(!0),n(y,null,v(e.entry.items,(a,l)=>(i(),n("tr",{key:a.id},[t("td",Dt,o(l+1),1),t("td",null,[d((i(),n("a",{class:"show-lnk",href:"javascript:void(0);","data-toggle":"modal","data-target":"#modal-item-details",onClick:w=>r.show(l)},[p(o(a.item_description),1)],8,Pt)),[[_,"Click para Mostrar Detalles de este producto"]])]),t("td",Ft,o(a.um),1),t("td",{id:"item-"+(l+1)+"-received",class:"text-center"},o(a.received_quantity),9,Ut),t("td",qt,o(a.price_unit),1),t("td",{id:"item-"+(l+1)+"-pricetotal",class:"text-right"},o(a.price_total),9,Nt),t("td",{id:"item-"+(l+1)+"-stowagecard",class:"text-center"},o(a.stowage_card),9,At),t("td",{id:"item-"+(l+1)+"-comment"},o(a.comment),9,St)]))),128))])])])],2),t("div",{class:c(["row pt-4",e.table_oc?"hidden":""])},[t("div",zt,[t("table",Tt,[$t,t("tbody",null,[(i(!0),n(y,null,v(e.entry.items,(a,l)=>(i(),n("tr",{key:a.id},[t("td",It,o(l+1),1),t("td",null,[d((i(),n("a",{class:"show-lnk",href:"javascript:void(0);","data-toggle":"modal","data-target":"#modal-item-details",onClick:w=>r.show(l)},[p(o(a.item_description),1)],8,Mt)),[[_,"Click para Mostrar Detalles de este producto"]])]),t("td",Bt,o(a.um),1),t("td",Jt,o(a.product_quantity),1),t("td",{id:"item-"+(l+1)+"-received",class:"text-center"},o(a.received_quantity),9,Ot),t("td",Vt,o(a.price_unit),1),t("td",{id:"item-"+(l+1)+"-pricetotal",class:"text-right"},o(a.price_total),9,Gt),t("td",{id:"item-"+(l+1)+"-stowagecard",class:"text-center"},o(a.stowage_card),9,Lt),t("td",{id:"item-"+(l+1)+"-comment"},o(a.comment),9,Rt)]))),128))])])])],2)]),t("div",Ht,[t("div",Kt,[t("div",Qt,[t("div",Wt,[Xt,t("button",Yt,xt,512)]),t("div",te,[t("form",ee,[d(t("input",{type:"hidden",name:"upload_id_entry",id:"upload_id_entry","onUpdate:modelValue":s[7]||(s[7]=a=>e.upload_id=a)},null,512),[[E,e.upload_id]]),t("div",se,[t("div",oe,[t("h6",ae,[p(" Entrada No. "),t("strong",null,o(e.upload_entry),1)])])]),t("div",ie,[t("div",ne,[t("div",le,[t("input",{id:"uploadFile",ref:"uploadFile",class:"form-control",type:"file",accept:".jpg,.jpeg,.png,.pdf",onChange:s[8]||(s[8]=(...a)=>r.onChangeFile&&r.onChangeFile(...a))},null,544),re])])]),e.upload_form_error.error_text!=""?(i(),n("div",de,[t("div",ce,[t("h6",_e,o(e.upload_form_error.error_text),1)])])):u("",!0)])]),t("div",pe,[he,t("button",{type:"button",class:"btn btn-primary btn-green ripple",disabled:e.upload_form_loading,onClick:s[9]||(s[9]=m(a=>r.uploadDoc(),["stop"]))},[e.upload_form_loading?(i(),n("i",fe)):(i(),n("i",ue)),p(" "+o(e.upload_form_okbtn_text),1)],8,me)])])])]),t("div",ye,[t("div",ge,[t("div",ve,[t("div",be,[we,t("button",ke,je,512)]),t("div",Ee,[t("div",De,[t("div",Pe,[Fe,t("h6",Ue,o(e.item_details.cod_product),1)])]),t("div",qe,[t("div",Ne,[Ae,t("h6",Se,o(e.item_details.oc),1)])]),e.table_oc&&e.show_details?(i(),n("div",ze,[t("div",Te,[$e,t("h6",Ie,o(e.item_details.generic_descript.toUpperCase()),1)])])):u("",!0),!e.table_oc&&e.show_details?(i(),n("div",Me,[t("div",Be,[Je,t("h6",Oe,o(e.item_details.docnum),1)])])):u("",!0),t("div",Ve,[t("div",Ge,[Le,t("h6",Re,o(e.item_details.item_description.toUpperCase()),1)])]),t("div",He,[t("div",{class:c(e.table_oc?"col-md-6":"col-md-4")},[Ke,t("h6",Qe,o(e.item_details.um),1)],2),e.table_oc?u("",!0):(i(),n("div",{key:0,class:c(e.table_oc?"col-md-6":"col-md-4")},[We,t("h6",Xe,o(e.item_details.product_quantity),1)],2)),t("div",{class:c(e.table_oc?"col-md-6":"col-md-4")},[Ye,t("h6",Ze,o(e.item_details.received_quantity),1)],2)]),t("div",xe,[t("div",ts,[es,t("h6",ss,o(e.item_details.price_unit),1)]),t("div",os,[as,t("h6",is,o(e.item_details.price_total),1)]),t("div",ns,[ls,t("h6",rs,o(e.item_details.stowage_card),1)])]),e.item_details.comment!=""&&e.item_details.comment!=null?(i(),n("div",ds,[t("div",cs,[_s,t("h6",ps,o(e.item_details.comment),1)])])):u("",!0)])])])])],64)}const ys=k(N,[["render",hs]]);export{ys as default};
