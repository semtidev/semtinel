import{_ as y}from"./app.523dd8ec.js";import{o as l,e as d,j as e,k as v,F as f,J as w,M as b,x as n,K as c,h as m,N as k,I as p,H as j,L as C}from"./vue.esm-bundler.5523ad96.js";const x={data:function(){return{poles:[],store_projects:[],store_warehouses:[],projects:[],warehouses:{pole:"",project:"",items:[]},poles_loading:!0,projects_loading:!0,warehouses_loading:!0,warehouses_empty:!1,loading:!0,form_title:"Nuevo Pa\xF1ol",form_data:{id:"",name:"",owner:"",active:1},form_action:"",form_error:"",form_okbtn_text:"Aceptar",form_color:"green",form_loading:!1,delete_text:"Eliminar",delete_id:"",delete_warehouse:"",delete_error:"",delete_loading:!1,session:JSON.parse(sessionStorage.getItem("semtinel"))}},watch:{form_okbtn_text:function(t){t=="Aceptar"?this.form_loading=!1:this.form_loading=!0},form_action:function(t){switch(t){case"create":this.form_color="green";break;case"edit":this.form_color="orange";break;default:this.form_color="danger";break}}},methods:{changePole:function(t,o){let s=this,r=[],h=[];s.warehouses.pole=o,s.projects_loading=!0,s.store_projects.map(function(i,_){i.id_pole==t&&r.push(i)}),s.projects=r,s.projects_loading=!1,s.projects.length>0?(s.warehouses.project=s.projects[0].id,s.warehouses_empty=!1):(s.warehouses.project="",s.warehouses_empty=!0),s.store_warehouses.map(function(i,_){i.id_project==s.warehouses.project&&h.push(i)}),s.warehouses.items=h,s.warehouses.items.length==0&&(this.warehouses_empty=!0),s.warehouses_loading=!1},changeProject:function(t){let o=this;o.warehouses.project=t},listReload:function(){this.getItemsTable()},async getItemsTable(){let t=this,o=[];t.warehouses_loading=!0;let s={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+t.session.access_token};await fetch("http://localhost/semtinel/public/api/logistics/warehouses",{method:"GET",headers:s}).then(r=>r.json()).then(r=>{t.store_warehouses=r,t.store_warehouses.map(function(h,i){h.id_project==t.warehouses.project&&o.push(h)}),t.warehouses.items=o,t.warehouses.items.length==0&&(this.warehouses_empty=!0),t.warehouses_loading=!1}).catch(r=>{this.errorMessage=r,toastr.error("Error: "+r)})},isValidForm:function(){return this.form_data.name==null||this.form_data.name==""?(this.form_error="Debe escribir un Nombre para el pa\xF1ol.",!1):this.form_data.owner==null||this.form_data.owner==""?(this.form_error="Debe escribir un Responsable del pa\xF1ol.",!1):!0},create:function(){this.form_action="create",this.form_error="",this.form_title="Nuevo Pa\xF1ol",this.form_data.id="",this.form_data.name="",this.form_data.owner="",this.form_data.active=1},edit:function(t,o,s,r){this.form_action="edit",this.form_error="",this.form_title="Editar Pa\xF1ol",this.form_data.id=t,this.form_data.name=o,this.form_data.owner=s,this.form_data.active=r},activeWarehouse:function(){this.form_data.active==1?this.form_data.active=0:this.form_data.active=1},deleteDialog:function(t,o){this.delete_id=t,this.delete_warehouse=o},async store(){let t=this;if(!t.isValidForm())return;t.form_error="",t.form_okbtn_text="Procesando...";let o={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+t.session.access_token};await axios.post("http://localhost/semtinel/public/api/logistics/warehouse",{id:t.form_data.id,project:t.warehouses.project,name:t.form_data.name,owner:t.form_data.owner,active:t.form_data.active},{headers:o}).then(function(s){s.data.success?(t.form_error="",t.form_okbtn_text="Aceptar",t.$refs.Close.click(),t.form_action=="create"?toastr.success("El Pa\xF1ol fue Agregado con \xE9xito."):t.form_action=="edit"&&toastr.success("El Pa\xF1ol fue Actualizado con \xE9xito."),t.listReload()):(t.form_error="",t.form_okbtn_text="Aceptar",t.error("Error al intentar realizar la operaci\xF3n."))}).catch(function(s){t.form_error="Ha ocurrido un error. Por favor, prueba nuevamente.",t.form_okbtn_text="Aceptar"})},async destroy(){let t=this;t.delete_error="",t.delete_loading=!0,t.delete_text="Procesando...";let o={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer "+t.session.access_token};await axios.delete("http://localhost/semtinel/public/api/logistics/warehouse/"+t.delete_id,{headers:o},{}).then(function(s){s.data.success?(t.delete_error="",t.delete_loading=!1,t.delete_text="Eliminar",t.$refs.delClose.click(),toastr.success("El Pa\xF1ol fue Eliminado con \xE9xito."),t.listReload()):(t.delete_error="",t.delete_loading=!1,t.delete_text="Eliminar",toastr.error("Error al intentar realizar la operaci\xF3n."))}).catch(function(s){t.delete_error="Ha ocurrido un error. Por favor, prueba nuevamente.",t.form_okbtn_text="Eliminar",t.delete_loading=!1})}},mounted(){JSON.parse(sessionStorage.getItem("semtinel")).access_token||(sessionStorage.clear(),window.document.location.href="http://localhost/semtinel/login");let t={"User-Agent":"testing/1.0",Accept:"application/json",Authorization:"Bearer 2|hRRNHI6VGAYQnUefCadsTzH6YrYYwodOVx8oMUTr"};fetch("http://localhost/semtinel/public/api/logistics/warehouses",{method:"GET",headers:t}).then(o=>o.json()).then(o=>{this.store_warehouses=o,fetch("http://localhost/semtinel/public/api/projects",{method:"GET",headers:t}).then(s=>s.json()).then(s=>{this.store_projects=s,fetch("http://localhost/semtinel/public/api/poles",{method:"GET",headers:t}).then(r=>r.json()).then(r=>{this.poles=r,this.changePole(r[0].id,r[0].abbr),this.poles_loading=!1}).catch(r=>{this.errorMessage=r,toastr.error("Error: "+r)})}).catch(s=>{this.errorMessage=s,toastr.error("Error: "+s)})}).catch(o=>{this.errorMessage=o,toastr.error("Error: "+o)})}},P={class:"container-fluid px-0"},E={class:"card card-default"},A=j('<div class="card-header"><h3 class="card-title">Polo &amp; Proyecto</h3><div class="card-tools"><button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button></div></div>',1),N={class:"card-body"},z={class:"row"},R={class:"col-md-3"},V={class:"form-group"},M=e("label",null,"Polo",-1),T=["disabled"],U={key:0},S=["value","selected","onClick"],B={class:"col-md-3"},D={class:"form-group"},I=e("label",null,"Proyecto",-1),$=["disabled"],G={key:0},H=["value","selected","onClick"],F={class:"card card-default"},Y={class:"card-header"},J=e("h3",{class:"card-title"},"Pa\xF1oles",-1),L={class:"card-tools"},O=e("i",{class:"mdi mdi-reload mdi-24px text-green"},null,-1),W=[O],q=e("i",{class:"mdi mdi-plus-circle mdi-24px text-green"},null,-1),K=[q],Q={class:"card-body"},X=e("div",{class:"col-12 text-center py-5 loading-table"},[e("h6",null,[e("span",{class:"mdi mdi-loading mdi-spin mdi-36px"},"\xA0Cargando pa\xF1oles...")])],-1),Z=[X],ee=e("div",{class:"col-12 text-center empty-table"},[e("h6",null,"Ning\xFAn Pa\xF1ol encontrado")],-1),te=[ee],oe={class:"col-12"},se={id:"datatable",class:"table table-striped"},ae=e("thead",null,[e("tr",null,[e("th",{width:"50",class:"text-center no-sort"},"No."),e("th",null,"Nombre"),e("th",null,"Responsable"),e("th",{class:"text-center no-sort"},"Activo"),e("th",{width:"100",class:"text-center no-sort"},"Modificar"),e("th",{width:"100",class:"text-center no-sort"},"Eliminar")])],-1),re={class:"text-center"},ie={class:"text-center"},le={class:"text-center"},de=["onClick"],ne=e("span",{class:"mdi mdi-pencil mdi-18px text-orange"},null,-1),ce=[ne],he={class:"text-center"},_e=["onClick"],me=e("span",{class:"mdi mdi-trash-can-outline mdi-18px text-danger"},null,-1),ue=[me],pe={class:"modal fade",id:"modal-warehouse-form","aria-hidden":"true",role:"dialog","data-backdrop":"static","data-keyboard":"false"},fe={class:"modal-dialog"},be={class:"modal-content"},ge={class:"modal-title"},ve={type:"button",ref:"Close",class:"close","data-dismiss":"modal","aria-label":"Close"},we=e("span",{"aria-hidden":"true"},"\xD7",-1),ke=[we],ye={class:"modal-body px-4"},je={class:"row"},Ce={class:"col-md-12"},xe={class:"form-group"},Pe=e("label",{for:"name"},"Nombre:",-1),Ee={class:"row"},Ae={class:"col-md-12"},Ne={class:"form-group"},ze=e("label",{for:"name"},"Responsable:",-1),Re={class:"row"},Ve={class:"col-md-12"},Me={class:"form-check ml-1"},Te=["checked"],Ue=e("label",{class:"form-check-label",for:"wh_active"},"Activo",-1),Se={key:0,class:"row pt-2"},Be={class:"col-12 text-center"},De={class:"form_error"},Ie={class:"modal-footer justify-content-between"},$e=e("button",{type:"button",class:"btn btn-default ripple","data-dismiss":"modal"},"Cancelar",-1),Ge=["disabled"],He={key:0,class:"mdi mdi-check-all"},Fe={key:1,class:"mdi mdi-loading mdi-spin"},Ye={class:"modal fade",id:"modal-warehouse-delete","aria-hidden":"true",role:"dialog","data-backdrop":"static","data-keyboard":"false"},Je={class:"modal-dialog modal-lg"},Le={class:"modal-content"},Oe={class:"modal-header header-danger"},We=e("h4",{class:"modal-title"},"Confirmaci\xF3n",-1),qe={type:"button",ref:"delClose",class:"close","data-dismiss":"modal","aria-label":"Close"},Ke=e("span",{"aria-hidden":"true"},"\xD7",-1),Qe=[Ke],Xe={class:"modal-body px-4"},Ze=e("div",{class:"float-start",style:{width:"70px"}},[e("i",{class:"mdi mdi-chat-question mdi-48px"})],-1),et={class:"float-start pt-3",style:{width:"85%"}},tt=e("br",null,null,-1),ot={class:"modal-footer justify-content-between"},st=e("button",{type:"button",class:"btn btn-default","data-dismiss":"modal"},"Cancelar",-1),at=["disabled"],rt=e("i",{class:"mdi mdi-trash-can-outline"},null,-1);function it(t,o,s,r,h,i){const _=C("tooltip");return l(),d(f,null,[e("div",P,[e("div",E,[A,e("div",N,[e("div",z,[e("div",R,[e("div",V,[M,e("select",{name:"pole",size:"1",class:"form-control",disabled:t.poles_loading},[t.poles_loading?(l(),d("option",U,"Cargando polos...")):v("",!0),(l(!0),d(f,null,w(t.poles,(a,u)=>(l(),d("option",{key:u,value:a.abbr,selected:t.warehouses.pole===a.abbr,onClick:b(g=>i.changePole(a.id,a.abbr),["stop"])},n(a.name),9,S))),128))],8,T)])]),e("div",B,[e("div",D,[I,e("select",{name:"project",size:"1",class:"form-control",disabled:t.projects_loading},[t.projects_loading?(l(),d("option",G,"Cargando proyectos...")):v("",!0),(l(!0),d(f,null,w(t.projects,(a,u)=>(l(),d("option",{key:u,value:a.abbr,selected:t.warehouses.project===a.abbr,onClick:b(g=>i.changeProject(a.abbr),["stop"])},n(a.name),9,H))),128))],8,$)])])])])]),e("div",F,[e("div",Y,[J,e("div",L,[c((l(),d("button",{type:"button",class:"btn btn-tool pl-0",onClick:o[0]||(o[0]=b(a=>i.listReload(),["stop"]))},W)),[[_,"Recargar Listado"]]),c((l(),d("button",{type:"button",class:"btn btn-tool pl-0","data-toggle":"modal","data-target":"#modal-warehouse-form",onClick:o[1]||(o[1]=a=>i.create())},K)),[[_,"Nuevo Pa\xF1ol"]])])]),e("div",Q,[e("div",{class:m(["row mt-3",t.warehouses_loading?"":"hidden"])},Z,2),e("div",{class:m(["row mt-3",t.warehouses_empty?"":"hidden"])},te,2),e("div",{class:m(["row",!t.warehouses_loading&&!t.warehouses_empty?"":"hidden"])},[e("div",oe,[e("table",se,[ae,e("tbody",null,[(l(!0),d(f,null,w(t.warehouses.items,(a,u)=>(l(),d("tr",{key:a.id},[e("td",re,n(u+1),1),e("td",null,n(a.name),1),e("td",null,n(a.owner),1),e("td",ie,[e("span",{class:m(["mdi mdi-18px",a.active?"mdi-checkbox-marked-circle":"mdi-checkbox-blank-circle-outline"])},null,2)]),e("td",le,[c((l(),d("a",{href:"javascript:void(0);",class:"btn-semti-tool",style:{padding:"4px 5px"},"data-toggle":"modal","data-target":"#modal-warehouse-form",onClick:g=>i.edit(a.id,a.name,a.owner,a.active)},ce,8,de)),[[_,"Modificar este Pa\xF1ol"]])]),e("td",he,[c((l(),d("a",{href:"javascript:void(0);",class:"btn-semti-tool",style:{padding:"4px 5px"},"data-toggle":"modal","data-target":"#modal-warehouse-delete",onClick:g=>i.deleteDialog(a.id,a.name)},ue,8,_e)),[[_,"Eliminar este Pa\xF1ol"]])])]))),128))])])])],2)])])]),e("div",pe,[e("div",fe,[e("div",be,[e("div",{class:m(["modal-header","header-"+t.form_color])},[e("h4",ge,n(t.form_title),1),e("button",ve,ke,512)],2),e("div",ye,[e("form",null,[c(e("input",{type:"hidden",name:"id_system",id:"id_system","onUpdate:modelValue":o[2]||(o[2]=a=>t.form_data.id=a)},null,512),[[k,t.form_data.id]]),e("div",je,[e("div",Ce,[e("div",xe,[Pe,c(e("input",{type:"text",class:"form-control",id:"name",name:"name",placeholder:"Nombre del sistema","onUpdate:modelValue":o[3]||(o[3]=a=>t.form_data.name=a)},null,512),[[k,t.form_data.name]])])])]),e("div",Ee,[e("div",Ae,[e("div",Ne,[ze,c(e("input",{type:"text",class:"form-control",id:"owner",name:"owner",placeholder:"Responsable del pa\xF1ol","onUpdate:modelValue":o[4]||(o[4]=a=>t.form_data.owner=a)},null,512),[[k,t.form_data.owner]])])])]),e("div",Re,[e("div",Ve,[e("div",Me,[e("input",{type:"checkbox",class:"form-check-input",id:"wh_active",name:"wh_active",checked:t.form_data.active,onChange:o[5]||(o[5]=a=>i.activeWarehouse())},null,40,Te),Ue])])]),t.form_error!=""?(l(),d("div",Se,[e("div",Be,[e("h6",De,n(t.form_error),1)])])):v("",!0)])]),e("div",Ie,[$e,e("button",{type:"button",class:m(["btn btn-primary ripple","btn-"+t.form_color]),disabled:t.form_loading,onClick:o[6]||(o[6]=b(a=>i.store(),["stop"]))},[t.form_loading?(l(),d("i",Fe)):(l(),d("i",He)),p(" \xA0"+n(t.form_okbtn_text),1)],10,Ge)])])])]),e("div",Ye,[e("div",Je,[e("div",Le,[e("div",Oe,[We,e("button",qe,Qe,512)]),e("div",Xe,[Ze,e("div",et,[e("p",null,[p('El Pa\xF1ol "'),e("strong",null,n(t.delete_warehouse),1),p('" ser\xE1 Eliminado de la plataforma Semtinel.'),tt,p("Confirme que desea realizar esta operaci\xF3n.")])])]),e("div",ot,[st,e("button",{type:"button",class:"btn btn-danger ripple",disabled:t.delete_loading,onClick:o[7]||(o[7]=a=>i.destroy())},[rt,p("\xA0"+n(t.delete_text),1)],8,at)])])])])],64)}const nt=y(x,[["render",it]]);export{nt as default};
